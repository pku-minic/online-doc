# Lv0.4 选择你的编程语言

自 2021 年秋季学期开始, 在编译实践中, 你可以使用 C, C++ 或者 Rust 来开发你的编译器.

## 获取项目模板

在编译实践中, 无论是在线评测系统还是本地的自动测试脚本, 都要求你的编译器仓库里具备 Make/CMake/Cargo 三者之一的配置文件. 这样, 评测工具才能利用 Make/CMake/Cargo 来编译你的编译器, 并进行后续评测.

考虑到大部分同学对这些工具并不了解, 我们制作了三个对应的项目模板, 模板里已经包含了可直接使用的 `Makefile`, `CMakeLists.txt` 或 `Cargo.toml`. 你可以在模板的 `src` 目录中新建源代码文件, 然后开始开发你的编译器.

* **Make 模板:** 参考 [`sysy-make-template`](https://github.com/pku-minic/sysy-make-template), 使用 C/C++ 开发编译器的同学可以参考.
* **CMake 模板:** 参考 [`sysy-cmake-template`](https://github.com/pku-minic/sysy-cmake-template), 使用 C/C++ 开发编译器的同学可以参考.
* **Cargo 模板:** 你并不需要任何模板, 你只需要在安装好 Rust 工具链的情况下, 执行 `cargo new 项目名称`, 然后当前目录下就会多出一个名为 `项目名称` 的目录, 在这个目录中开发即可. 当然, 为了和 Make/CMake 模板呼应, 我们还是新建了一个叫做 [`sysy-cargo-template`](https://github.com/pku-minic/sysy-cargo-template) 的项目.

请务必仔细阅读模板中的 `README`. 如果你使用 Make/CMake 模板, 你应该根据你选择的语言 (C/C++), 更新 `Makefile`/`CMakeLists.txt` 中 `CPP_MODE` 参数的值.

## 建议的开发方式

我们建议大家:

1. 在你的宿主机 (Windows/macOS/Linux) 中完成 Docker 的配置.
2. 在你的宿主机中安装并配置合适的编辑器/IDE, 例如 VS Code 或 IDEA.
3. 选择对应的项目模板, 并在宿主机中开发你的编译器.
4. 配置在线评测平台的 GitLab, 并上传你的项目, 时刻使用 Git 管理代码.
5. 当需要本地测试时, 使用 Docker 环境中的自动测试脚本进行测试 (之后章节会介绍).
6. 当需要在线评测时, 向在线评测平台提交你的 GitLab 仓库 (之后章节会介绍).

课程结束后, 如果你什么都不想带走, 只需要:

1. 删除你的项目.
2. 删除 Docker 里的实验环境镜像, 必要时也可以删除 Docker.

## 建议的编程语言

**通常情况下, 我们建议你使用 C/C++ 开发你的编译器.** 这是最稳妥的选择, 因为你一定在很多其他课程中学习/使用过这两门编程语言. 在编译实践中, 除了使用 C/C++ 编程, 你还会遇到很多其他问题, 例如:

* 如何将你的项目分成多个部分, 拆分到多个文件中实现?
* 如何使用 C/C++ 构造复杂的数据结构?
* 如何优雅地管理内存?
* 如何调试, 定位并解决一些看起来很没有头绪的问题?

等等. 如果你之前仅限于 “会使用 C/C++ 编程”, 相信在完成编译实践之后, 你会对 “如何使用 C/C++ 解决一个工程问题” 这件事有一个更为全面的认识.

**我们建议之前接触过 Rust, 且对 Rust 感兴趣的同学使用 Rust 开发你的编译器:**

* 一方面, 课程中的 Koopa IR 框架本身就是使用 Rust 开发的, 它在 Rust 层面提供了更丰富的接口和更合理的抽象.
* 另一方面, 如果你之前并未使用 Rust 完成过较为复杂的项目, 那么使用 Rust 开发编译器会是一个很不错的开始, 并且我们相信在此之后, 你对 Rust 的理解也会更进一步.

**我们不建议之前从未接触过 Rust, 对内存管理/所有权等概念不敏感, 且对自己编码水平没什么信心的同学使用 Rust 开发编译器.** 对这些同学来说, 在编译实践中上手 Rust 可能会比较痛苦.
